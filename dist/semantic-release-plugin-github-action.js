"use strict";var f=require("execa");const c=async(e,s=[])=>await f.execa("git",[e,...s]),w=(e,{allowEmpty:s=!1,keyid:o,sign:l=!1}={})=>{const t=[];if(l){const n="-S",r=typeof o=="string"&&o!==""?`${n}"${o}"`:n;t.push(r)}return s&&t.push("--allow-empty"),[...t,"-m",`"${e}"`]},$=async(e,s={})=>{const o=w(e,s);return await c("commit",o)},y=(e,{delete:s=!1,remote:o="origin",signed:l=!1}={})=>{const t=[o,e];return s?[o,"-d",e]:(l!==!1&&t.push(`--signed="${l}"`),t)},b=async(e,s={})=>{const o=y(e,s);return await c("push",o)},v=(e,{commit:s,delete:o=!1,message:l="",sign:t=!1}={})=>{if(o)return["-d",e];const n=[];return t&&n.push("-s"),n.push(e),s!==void 0&&n.push(s),[...n,"-m",`"${l}"`]},x=async(e,s={})=>{const o=v(e,s);return await c("tag",o)},a=c,g=e=>({value:e,enumerable:!0,configurable:!1,writable:!1});Object.defineProperties(a,{commit:g($),tag:g(x),push:g(b)});const E=({branch:e,nextRelease:s})=>({branch:e.name,version:s.version,tag:s.gitTag,notes:s.notes??""}),j=async(e={},s)=>{const{branch:o,version:l,tag:t,notes:n}=E(s);console.log("options:",e),console.log("branch:",o),console.log("version:",l),console.log("tag:",t),console.log("notes:",n),console.log("-------------- using git. delete local tag ----------");const r=await a.tag(t,{delete:!0});console.log("stderr:",r.stderr),console.log("stdout:",r.stdout),console.log("-------------- using git. delete remote tag ---------");const i=await a.push(t,{delete:!0});console.log("stderr:",i.stderr),console.log("stdout:",i.stdout);const u=`release: ${t}`;console.log("-------------- using git. commit release ------------");const d=await a.commit(`${u}

${n}`,{sign:!0,allowEmpty:!0});console.log("stderr:",d.stderr),console.log("stdout:",d.stdout),console.log("-------------- using git. tag release ---------------");const m=await a.tag(t,{sign:!0,message:`${u}

${n}`});console.log("stderr:",m.stderr),console.log("stdout:",m.stdout),console.log("-------------- using git. push commit release --------------");const p=await a.push(o);console.log("stderr:",p.stderr),console.log("stdout:",p.stdout),console.log("-------------- using git. push tag release --------------");const h=await a.push(t);console.log("stderr:",h.stderr),console.log("stdout:",h.stdout)};exports.publish=j;
